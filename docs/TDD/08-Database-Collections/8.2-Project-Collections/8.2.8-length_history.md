# 8.2.8 length history

Individual pipe/item length tracking from tally file uploads

| Field | Data Type | Description |
|-------|-----------|-------------|
| _id | String | Primary key (ObjectId as string) |
| id_item | String | Item reference (ObjectId as string) |
| id_manufacturer | String | Manufacturer reference (ObjectId as string) |
| id_spec_manufacturing | String | Manufacturing specification reference (ObjectId as string) |
| id_tally_file | String | Tally file reference (ObjectId as string) |
| id_report_file | String, null | Report file attachment reference (ObjectId as string) or null |
| heat_no | String | Heat number for material traceability (sample: "CCL-1", "H12345") |
| pipe_no | String | Individual pipe/item number (sample: "CL-0001", "P001") |
| length | Number | Pipe length in millimeters (sample: 12200, 11850, 12150) |
| qty_unit | String | Quantity unit (sample: "PCS", "M") |
| coating_type | String, undefined | Coating type for coating items (sample: "3lpe", "fbe") |
| date_upload | Date | Upload date (ISODate) |
| readable_date_upload | String | Display format upload date in DD/MM/YY (sample: "23/04/25") |
| status | String | Resolution status (sample: "unresolved", "resolved") |
| reason | String, null | Reason for status or null |
| remark | String, null | Additional remarks or null |
| photos | Array | Array of photo attachments (typically empty) |
| created_at | Date | Creation timestamp (ISODate) |
| created_by | String | Creator user email |
| updated_at | Date | Last update timestamp (ISODate) |
| updated_by | String | Last updater user email |

## Notes

- This collection stores **individual pipe/item records** extracted from uploaded tally files
- Each record represents one pipe/item with its heat number, pipe number, and length
- Data is imported from Excel tally files uploaded by manufacturers via the `id_tally_file` reference
- **Important**: Length is stored in **millimeters**, not meters (e.g., 12200 = 12.2 meters)
- The `status` field tracks whether discrepancies or issues have been resolved
- `id_report_file` links to supporting documentation when available
- Used for material traceability and grouping pipes by heat number and pipe number
- The repository provides aggregation methods to group by:
  - Pipe/heat combination (`groupPipeHeat`)
  - Item/specification combination (`groupItemSpec`)
  - Report file (`genFilterHistory`, `getTotalMappedReport`)
- Photos array is typically empty in practice (photos are attached to tally files instead)

